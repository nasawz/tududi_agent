# 标签管理API文档

## 概述
标签管理API提供标签的CRUD操作，用于对任务和笔记进行分类和标记。标签是跨项目的通用分类系统。

## 基础路径
```
/api
```

## 认证方式
- 需要有效的登录会话
- 所有操作仅限当前用户自己的数据

## 数据模型

### Tag（标签）
| 字段 | 类型 | 说明 |
|------|------|------|
| uid | string | 标签唯一标识符 |
| name | string | 标签名称 |
| user_id | number | 所属用户ID |

## 接口列表

### 1. 获取所有标签

#### 请求
```http
GET /api/tags
```

#### 响应
**成功 (200)**
```json
[
  {
    "name": "重要",
    "uid": "tag_important123"
  },
  {
    "name": "紧急",
    "uid": "tag_urgent456"
  },
  {
    "name": "前端",
    "uid": "tag_frontend789"
  }
]
```

#### 响应字段说明
| 字段 | 类型 | 说明 |
|------|------|------|
| name | string | 标签名称 |
| uid | string | 标签UID |

#### 错误响应
| 状态码 | 说明 |
|--------|------|
| 500 | 服务器内部错误 |

---

### 2. 获取单个标签

#### 请求
```http
GET /api/tag?uid=tag_important123
# 或
GET /api/tag?name=重要
```

#### 查询参数（任选其一）
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| uid | string | 否 | 标签UID |
| name | string | 否 | 标签名称（URL编码） |

#### 响应
**成功 (200)**
```json
{
  "name": "重要",
  "uid": "tag_important123"
}
```

#### 错误响应
| 状态码 | 说明 |
|--------|------|
| 404 | 标签不存在 |
| 500 | 服务器内部错误 |

---

### 3. 创建标签

#### 请求
```http
POST /api/tag
```

#### 请求体
```json
{
  "name": "高优先级"
}
```

#### 参数说明
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| name | string | 是 | 标签名称 |

#### 标签名称验证规则
- 不能为空
- 不能与现有标签重复
- 不能超过一定长度（具体限制由validateTagName决定）

#### 响应
**成功 (201)**
```json
{
  "name": "高优先级",
  "uid": "tag_highpriority123"
}
```

#### 错误响应
| 状态码 | 说明 |
|--------|------|
| 400 | 标签名称无效或不符合规则 |
| 409 | 标签名称已存在 |
| 500 | 服务器内部错误 |

#### 错误示例
```json
{
  "error": "Tag name cannot be empty"
}
```

---

### 4. 更新标签

#### 请求
```http
PATCH /api/tag/tag_important123
# 或
PATCH /api/tag/important
```

#### 路径参数
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| identifier | string | 是 | 标签UID或标签名称 |

#### 请求体
```json
{
  "name": "非常重要"
}
```

#### 参数说明
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| name | string | 是 | 新的标签名称 |

#### 响应
**成功 (200)**
```json
{
  "name": "非常重要",
  "uid": "tag_important123"
}
```

#### 错误响应
| 状态码 | 说明 |
|--------|------|
| 400 | 标签名称无效或不符合规则 |
| 404 | 标签不存在 |
| 409 | 标签名称已存在 |
| 500 | 服务器内部错误 |

---

### 5. 删除标签

#### 请求
```http
DELETE /api/tag/tag_important123
# 或
DELETE /api/tag/important
```

#### 路径参数
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| identifier | string | 是 | 标签UID或标签名称 |

#### 响应
**成功 (204)**
```
No Content
```

#### 错误响应
| 状态码 | 说明 |
|--------|------|
| 404 | 标签不存在 |
| 500 | 服务器内部错误 |

## 使用场景

### 标签应用
- 标记任务的重要程度（重要、紧急、普通）
- 标记任务的类型（前端、后端、测试）
- 标记项目阶段（计划中、进行中、已完成）
- 跨项目分类（学习、工作、个人）

### 跨项目复用
- 标签在所有项目中通用
- 相同名称的标签会被复用
- 不需要为每个项目单独创建标签

## 注意事项
1. **唯一性**：每个用户下标签名称必须唯一
2. **查找方式**：支持通过UID或名称查找标签
3. **级联删除**：删除标签时会自动从所有关联的任务和笔记中移除
4. **名称验证**：使用validateTagName函数进行名称验证
5. **国际化**：标签名称支持多语言
6. **数据隔离**：用户只能操作自己的标签

## 相关端点
- **任务**：`/api/tasks/*` - 任务管理（可关联标签）
- **笔记**：`/api/notes/*` - 笔记管理（可关联标签）
- **项目**：`/api/projects/*` - 项目管理（可关联标签）
